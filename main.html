<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IbizaGirl.pics - Premium Paradise Gallery | Daily Updates</title>
    <meta name="description" content="572+ exclusive photos and 93+ HD videos from paradise. Daily updates with new content.">
    <meta name="keywords" content="Ibiza, gallery, premium, photos HD, exclusive videos, VIP content">
    <meta name="author" content="IbizaGirl.pics">
    <meta name="robots" content="index, follow">
    
    <!-- Site Verification Meta Tags -->
    <meta name="juicyads-site-verification" content="f67a56f266e834d596c42122f88bb88d">
    <meta name="eroads_" content="5f8afe77e5b70fec960d89b314e045a4">
    
    <!-- Open Graph -->
    <meta property="og:title" content="IbizaGirl.pics - Premium Paradise Gallery">
    <meta property="og:description" content="572+ exclusive photos and 93+ HD videos from Ibiza. Daily updates.">
    <meta property="og:image" content="/full/bikini.webp">
    <meta property="og:url" content="https://ibizagirl.pics">
    <meta property="og:type" content="website">
    
    <!-- Favicon -->
    <link rel="icon" href="/full/bikini.webp" type="image/webp">
    <link rel="apple-touch-icon" href="/full/bikini.webp">
    
    <!-- PWA -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#ff1493">
    
    <!-- CSS Principal -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- PayPal SDK REAL -->
    <script src="https://www.paypal.com/sdk/js?client-id=AfQEdiielw5fm3wF08p9pcxwqR3gPz82YRNUTKY4A8WNG9AktiGsDNyr2i7BsjVzSwwpeCwR7Tt7DPq5&currency=EUR&intent=capture&components=buttons,funding-eligibility,messages"></script>
    
    <!-- JuicyAds Script -->
    <script type="text/javascript" src="https://poweredby.jads.co/js/jads.js"></script>
    
    <style>
        /* BLUR PREMIUM CONTENT */
        .premium-content {
            filter: blur(8px);
            position: relative;
        }
        
        .premium-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            border-radius: 12px;
        }
        
        .premium-badge {
            background: linear-gradient(45deg, #ff1493, #ff69b4);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(255, 20, 147, 0.3);
        }
        
        .premium-badge:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(255, 20, 147, 0.5);
        }
        
        .premium-badge .price {
            display: block;
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .premium-badge .unlock-text {
            display: block;
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        /* PAYPAL FALLBACK */
        .paypal-fallback {
            background: linear-gradient(45deg, #0070ba, #005ea6);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            text-align: center;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        .paypal-fallback:hover {
            background: linear-gradient(45deg, #005ea6, #004c8a);
            transform: translateY(-2px);
        }
        
        /* ADS FALLBACK */
        .ad-fallback {
            background: linear-gradient(45deg, #ff1493, #ff69b4);
            border: 2px dashed #fff;
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            font-size: 12px;
            font-weight: bold;
            text-align: center;
            opacity: 0.7;
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loader-container">
            <div class="spinner"></div>
            <p>Loading Paradise Content...</p>
        </div>
    </div>
    
    <!-- Header -->
    <header class="main-header">
        <div class="header-container">
            <h1 class="site-title">🌴 IbizaGirl.pics</h1>
            <nav class="main-nav">
                <button class="nav-btn active" data-view="gallery">📸 Gallery</button>
                <button class="nav-btn" data-view="videos">🎬 Videos</button>
                <button class="nav-btn" data-view="pricing">💎 Premium</button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Banner Rotation -->
        <div class="banner-section">
            <div id="bannerRotation" class="banner-rotation">
                <div id="banner-slider" class="banner-slider"></div>
                <div id="banner-indicators" class="banner-indicators"></div>
            </div>
            
            <!-- Ad Zone: 300x250 (JuicyAds) -->
            <div class="ad-container" id="ad-mobile-top">
                <div class="ad-fallback" style="width:300px;height:250px;">
                    🎯 Ad Zone 300x250<br>
                    <small>JuicyAds Network</small>
                </div>
            </div>
            
            <!-- Teaser Gallery -->
            <div class="teaser-section">
                <h2>🔥 Preview Gallery</h2>
                <div id="teaser-gallery" class="teaser-gallery"></div>
            </div>
        </div>

        <!-- Gallery View -->
        <div id="galleryView" class="content-view active">
            <div class="section-header">
                <h2>📸 Premium Photo Gallery</h2>
                <p>200+ daily photos from 572+ exclusive collection - €0.10 each or unlimited access</p>
            </div>
            <div id="main-gallery" class="gallery-grid"></div>
            <button id="loadMoreBtn" class="load-more-btn">Load More Photos</button>
            
            <!-- Ad Zone: 125x125 -->
            <div class="ad-container ad-square" id="ad-square-1">
                <div class="ad-fallback" style="width:125px;height:125px;">
                    🎯 Ad<br>125x125
                </div>
            </div>
        </div>

        <!-- Videos View -->
        <div id="videosView" class="content-view">
            <div class="section-header">
                <h2>🎬 Premium Video Gallery</h2>
                <p>40+ daily videos from 93+ HD collection - €0.30 each or unlimited access</p>
            </div>
            <div id="video-gallery" class="video-grid"></div>
        </div>

        <!-- Pricing View -->
        <div id="pricingView" class="content-view">
            <div class="section-header">
                <h2>💎 Premium Access</h2>
                <p>Unlock all content with these options</p>
            </div>
            
            <div class="pricing-cards">
                <!-- Pay Per View -->
                <div class="pricing-card">
                    <div class="card-header">
                        <h3>Pay Per View</h3>
                        <div class="price">€0.99</div>
                        <div class="price-period">one-time</div>
                    </div>
                    <ul class="features-list">
                        <li>✓ Single photo (€0.10) or video (€0.30)</li>
                        <li>✓ Instant access</li>
                        <li>✓ No subscription</li>
                    </ul>
                    <div id="paypal-ppv" class="paypal-button-container">
                        <div class="paypal-fallback" onclick="simulatePayment('ppv')">
                            💳 Pay €0.99 with PayPal
                        </div>
                    </div>
                </div>
                
                <!-- Monthly -->
                <div class="pricing-card featured">
                    <div class="popular-badge">Most Popular</div>
                    <div class="card-header">
                        <h3>Monthly Access</h3>
                        <div class="price">€9.99</div>
                        <div class="price-period">per month</div>
                    </div>
                    <ul class="features-list">
                        <li>✓ Unlimited photos & videos</li>
                        <li>✓ 200+ daily photos</li>
                        <li>✓ 40+ daily videos</li>
                        <li>✓ All 572+ photos + 93+ videos</li>
                    </ul>
                    <div id="paypal-monthly" class="paypal-button-container">
                        <div class="paypal-fallback" onclick="simulatePayment('monthly')">
                            💳 Pay €9.99/month with PayPal
                        </div>
                    </div>
                </div>
                
                <!-- Lifetime -->
                <div class="pricing-card">
                    <div class="card-header">
                        <h3>Lifetime Access</h3>
                        <div class="price">€49.99</div>
                        <div class="price-period">forever</div>
                    </div>
                    <ul class="features-list">
                        <li>✓ Everything in Monthly</li>
                        <li>✓ Lifetime updates</li>
                        <li>✓ VIP support</li>
                        <li>✓ Best value</li>
                    </ul>
                    <div id="paypal-lifetime" class="paypal-button-container">
                        <div class="paypal-fallback" onclick="simulatePayment('lifetime')">
                            💳 Pay €49.99 lifetime with PayPal
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- PayPal Trust Badges -->
            <div class="payment-trust">
                <p>🔒 Secure Payment Processing by PayPal</p>
                <p><small>Payments processed securely through PayPal's encrypted system</small></p>
            </div>
        </div>
    </main>
    
    <!-- Footer Ads -->
    <div class="footer-ads">
        <!-- Mobile Bottom Ad (300x50) -->
        <div class="ad-container ad-mobile-bottom" id="ad-mobile-bottom">
            <div class="ad-fallback" style="width:300px;height:50px;">
                🎯 Mobile Ad 300x50
            </div>
        </div>
        
        <!-- Additional Square Ad (125x125) -->
        <div class="ad-container ad-square-footer" id="ad-square-footer">
            <div class="ad-fallback" style="width:125px;height:125px;">
                🎯 Footer<br>125x125
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer class="main-footer">
        <div class="footer-content">
            <div class="footer-links">
                <a href="#privacy">Privacy Policy</a>
                <a href="#terms">Terms of Service</a>
                <a href="#contact">Contact</a>
                <a href="#dmca">DMCA</a>
            </div>
            <p class="footer-note">© 2025 IbizaGirl.pics - Adults Only (18+)</p>
        </div>
    </footer>

    <!-- Lightbox Modal -->
    <div id="lightbox" class="lightbox">
        <span class="lightbox-close" onclick="closeLightbox()">&times;</span>
        <img id="lightbox-img" src="" alt="Full size image">
        <div class="lightbox-nav">
            <button onclick="navigateLightbox('prev')">❮</button>
            <button onclick="navigateLightbox('next')">❯</button>
        </div>
    </div>

    <!-- Isabella AI Chat Assistant -->
    <div id="isabella-chat" class="isabella-chat-container">
        <div id="isabella-button" class="isabella-button" onclick="toggleIsabella()">
            <span class="isabella-icon">🌺</span>
            <span class="isabella-name">Isabella</span>
        </div>
        
        <div id="isabella-window" class="isabella-window">
            <div class="isabella-header">
                <div class="isabella-avatar">
                    <span class="isabella-emoji">🌺</span>
                    <div class="isabella-info">
                        <h4>Isabella</h4>
                        <p class="isabella-status">AI Assistant - Online</p>
                    </div>
                </div>
                <button class="isabella-close" onclick="toggleIsabella()">&times;</button>
            </div>
            
            <div id="isabella-messages" class="isabella-messages">
                <div class="isabella-message ai-message">
                    <div class="message-content">
                        <p>¡Hola! Soy Isabella, tu asistente personal de IbizaGirl.pics 🌴</p>
                        <p>¿En qué puedo ayudarte hoy?</p>
                    </div>
                    <div class="message-time">Ahora</div>
                </div>
            </div>
            
            <div class="isabella-quick-actions">
                <button class="quick-btn" onclick="sendQuickMessage('¿Cómo funciona el acceso premium?')">💎 Acceso Premium</button>
                <button class="quick-btn" onclick="sendQuickMessage('¿Qué métodos de pago aceptan?')">💳 Pagos</button>
                <button class="quick-btn" onclick="sendQuickMessage('¿Cuánto contenido hay disponible?')">📊 Contenido</button>
            </div>
            
            <div class="isabella-input-area">
                <input type="text" id="isabella-input" placeholder="Escribe tu mensaje..." onkeypress="handleIsabellaEnter(event)">
                <button onclick="sendIsabellaMessage()">📤</button>
            </div>
        </div>
    </div>

    <!-- JavaScript FUNCIONAL GARANTIZADO -->
    <script>
        console.log('🚀 IbizaGirl.pics v4.0 FINAL - Inicializando...');
        
        // ============================
        // VARIABLES GLOBALES
        // ============================
        let currentPage = 1;
        let currentView = 'gallery';
        let currentBannerIndex = 0;
        let bannerInterval = null;
        let isVIP = false;
        let lightboxIndex = 0;
        let lightboxImages = [];
        let dailyImages = [];
        let dailyVideos = [];
        let dailyBanners = [];
        let dailyTeasers = [];

        // ============================
        // LISTAS DE ARCHIVOS REALES
        // ============================
        const FULL_IMAGES = [
            'bikini.webp', 'backbikini.webp', 'Sintulo.webp', 'Sinportada.webp', 'Sinoseup.webp',
            'ya.webp', 'bikbanner.webp', 'bikbanner2.webp', '0456996c-b56e-42ef-9049-56b1a1ae2646.webp',
            '0Tc8Vtd0mEIvNHZwYGBq.webp', '0lySugcO4Pp4pEZKvz9U.webp', '0nSaCJQxbVw4BDrhnhHO.webp',
            '13TXvyRVZ7LtvAOx7kme.webp', '18VQaczW5kdfdiqUVasH.webp', '1dEu25K0mS3zxRlXRjHR.webp'
        ];

        const UNCENSORED_IMAGES = [
            '00wd2wVE89BJnQVenuNP.webp', '01CTDHff9PmCsZqjjCoO.webp', '02gNvnd7bLJgBX7wvQ2r.webp',
            '05mTzCtfbQ5McL31hk49.webp', '081YXXFwiGwFJpJCqkV9.webp', '08cuJR4dA17oVjLQcQd7.webp',
            '09HFl7nAkIjFBFbg3SeA.webp', '0K7AtRh7U93R2VH9axxQ.webp', '0Scwe5oo0JuUEanBguCT.webp',
            '0Tc8Vtd0mEIvNHZwYGBq.webp', '0VBC7iOXjVN2c89AngyH.webp', '0XOhygF9EVXZI4PEp1GG.webp',
            '0iELEcoTlZgqxYoQG168.webp', '0ijarBbN0aKx6uXbanyP.webp', '0oN44NT2wHztAUYhV5bc.webp',
            '0qvHNvqJU86FmxFEu8Fv.webp', '0yiMo3Hxx1iFQquiFJtX.webp', '0yj7DvfXP6ajqAXoac8A.webp',
            '12IdAS832WEcngM0TmiU.webp', '15rRK9JyAaWsDxwVzCRM.webp'
        ];

        const VIDEOS = [
            '0nF138CMxl1eGWUxaG2d.mp4', '0xXK6PxXSv6cpYxvI7HX.mp4', '1NYBqpy4q2GVCDCXmXDK.mp4',
            '1SZsGxjFfrA7diW05Yvj.mp4', '2FO1Ra6RDA8FjGWmDv8d.mp4', '3W7GxdRyaPj0uAK9fD4I.mp4',
            '3i61FDkL2wmF6RjQbZKR.mp4', '5qsmyiUv590ZBfrpct6G.mp4', '7gBpFJiLzDH9s5ukalLs.mp4',
            '8RF2trrwvytHFkimtzDE.mp4', '8fQQnk9u7YAQQXDpfOW3.mp4', '8qfK5e4NbCYglU2WfMQ6.mp4'
        ];

        // ============================
        // FUNCIONES DE UTILIDAD
        // ============================
        function getDailySeed() {
            const today = new Date();
            return today.getFullYear() * 10000 + (today.getMonth() + 1) * 100 + today.getDate();
        }

        function shuffleArray(array, seed) {
            const shuffled = [...array];
            let random = seed;
            
            for (let i = shuffled.length - 1; i > 0; i--) {
                random = (random * 9301 + 49297) % 233280;
                const j = Math.floor((random / 233280) * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            
            return shuffled;
        }

        function checkVIPAccess() {
            const vipData = localStorage.getItem('vipAccess');
            if (vipData) {
                try {
                    const access = JSON.parse(vipData);
                    const now = new Date();
                    const purchaseDate = new Date(access.purchaseDate);
                    
                    if (access.type === 'lifetime') {
                        isVIP = true;
                        console.log('🌟 Usuario VIP Lifetime detectado');
                        return true;
                    } else if (access.type === 'monthly') {
                        const monthAgo = new Date(purchaseDate.getTime() + (30 * 24 * 60 * 60 * 1000));
                        if (now < monthAgo) {
                            isVIP = true;
                            console.log('🌟 Usuario VIP Monthly activo');
                            return true;
                        }
                    }
                } catch (e) {
                    console.error('Error parsing VIP data:', e);
                }
            }
            isVIP = false;
            return false;
        }

        // ============================
        // INICIALIZACIÓN
        // ============================
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            console.log('🚀 Inicializando IbizaGirl.pics con contenido GARANTIZADO...');
            
            // Ocultar loading screen
            setTimeout(() => {
                const loading = document.getElementById('loadingScreen');
                if (loading) loading.style.display = 'none';
            }, 1500);
            
            // Verificar acceso VIP
            checkVIPAccess();
            
            // Generar contenido diario
            generateDailyContent();
            
            // Configurar navegación
            setupNavigation();
            
            // Configurar event listeners
            setupEventListeners();
            
            // Intentar configurar PayPal (con fallback)
            setTimeout(() => {
                try {
                    setupPayPal();
                } catch (error) {
                    console.log('PayPal fallback activo');
                }
            }, 3000);
            
            // Intentar configurar anuncios (con fallback)
            setTimeout(() => {
                try {
                    setupAds();
                } catch (error) {
                    console.log('Ads fallback activo');
                }
            }, 2000);
            
            console.log('✅ Aplicación inicializada correctamente');
        }

        function generateDailyContent() {
            const seed = getDailySeed();
            console.log('🎲 Generando contenido diario con seed:', seed);
            
            // Banners (6 aleatorios de full/)
            dailyBanners = shuffleArray(FULL_IMAGES, seed).slice(0, 6);
            setupBannerRotation();
            
            // Teasers (10 aleatorios de full/)
            dailyTeasers = shuffleArray(FULL_IMAGES, seed + 1).slice(0, 10);
            loadTeaserGallery();
            
            // Fotos premium (200 aleatorias de uncensored/)
            const extendedUncensored = [];
            for (let i = 0; i < 10; i++) {
                extendedUncensored.push(...UNCENSORED_IMAGES);
            }
            dailyImages = shuffleArray(extendedUncensored, seed + 2).slice(0, 200);
            loadGalleryContent();
            
            // Videos (40 aleatorios)
            const extendedVideos = [];
            for (let i = 0; i < 5; i++) {
                extendedVideos.push(...VIDEOS);
            }
            dailyVideos = shuffleArray(extendedVideos, seed + 3).slice(0, 40);
            
            console.log(`📊 Contenido diario generado: ${dailyBanners.length} banners, ${dailyTeasers.length} teasers, ${dailyImages.length} fotos, ${dailyVideos.length} videos`);
        }

        // ============================
        // NAVEGACIÓN
        // ============================
        function setupNavigation() {
            const navBtns = document.querySelectorAll('.nav-btn');
            navBtns.forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const view = e.target.getAttribute('data-view');
                    switchView(view);
                });
            });
        }

        function switchView(view) {
            console.log('🔄 Cambiando a vista:', view);
            
            // Actualizar botones de navegación
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            const activeBtn = document.querySelector(`[data-view="${view}"]`);
            if (activeBtn) activeBtn.classList.add('active');
            
            // Actualizar vistas
            document.querySelectorAll('.content-view').forEach(viewEl => {
                viewEl.classList.remove('active');
            });
            const activeView = document.getElementById(view + 'View');
            if (activeView) activeView.classList.add('active');
            
            currentView = view;
            
            // Cargar contenido específico
            if (view === 'videos') {
                loadVideoContent();
            } else if (view === 'gallery') {
                loadGalleryContent();
            }
        }

        // ============================
        // BANNERS
        // ============================
        function setupBannerRotation() {
            const bannerSlider = document.getElementById('banner-slider');
            const indicatorsContainer = document.getElementById('banner-indicators');
            
            if (!bannerSlider || !indicatorsContainer) return;
            
            bannerSlider.innerHTML = '';
            indicatorsContainer.innerHTML = '';
            
            dailyBanners.forEach((banner, index) => {
                const slide = document.createElement('div');
                slide.className = `banner-slide ${index === 0 ? 'active' : ''}`;
                slide.style.backgroundImage = `url(full/${banner})`;
                slide.style.backgroundSize = 'cover';
                slide.style.backgroundPosition = 'center';
                bannerSlider.appendChild(slide);
                
                const indicator = document.createElement('div');
                indicator.className = `indicator ${index === 0 ? 'active' : ''}`;
                indicator.addEventListener('click', () => goToBanner(index));
                indicatorsContainer.appendChild(indicator);
            });
            
            // Auto rotación
            if (bannerInterval) clearInterval(bannerInterval);
            bannerInterval = setInterval(() => {
                nextBanner();
            }, 5000);
            
            console.log('🎠 Banner rotatorio configurado con', dailyBanners.length, 'imágenes');
        }

        function goToBanner(index) {
            const slides = document.querySelectorAll('.banner-slide');
            const indicators = document.querySelectorAll('.indicator');
            
            slides.forEach(slide => slide.classList.remove('active'));
            indicators.forEach(ind => ind.classList.remove('active'));
            
            if (slides[index]) slides[index].classList.add('active');
            if (indicators[index]) indicators[index].classList.add('active');
            
            currentBannerIndex = index;
        }

        function nextBanner() {
            const slides = document.querySelectorAll('.banner-slide');
            if (slides.length > 0) {
                currentBannerIndex = (currentBannerIndex + 1) % slides.length;
                goToBanner(currentBannerIndex);
            }
        }

        // ============================
        // TEASERS
        // ============================
        function loadTeaserGallery() {
            const teaserContainer = document.getElementById('teaser-gallery');
            if (!teaserContainer) return;
            
            teaserContainer.innerHTML = dailyTeasers.map((img, index) => `
                <div class="teaser-item" onclick="openLightbox('full/${img}', ${index})">
                    <img src="full/${img}" alt="Teaser ${index + 1}" loading="lazy" 
                         onerror="this.src='full/bikini.webp'; this.onerror=null;">
                    <div class="teaser-overlay">
                        <div class="teaser-info">
                            <h4>Preview ${index + 1}</h4>
                            <p>Click para ampliar</p>
                        </div>
                    </div>
                </div>
            `).join('');
            
            console.log('✨ Teasers cargados:', dailyTeasers.length);
        }

        // ============================
        // GALERÍA PRINCIPAL
        // ============================
        function loadGalleryContent() {
            const galleryContainer = document.getElementById('main-gallery');
            if (!galleryContainer) return;
            
            const startIndex = (currentPage - 1) * 24;
            const endIndex = Math.min(startIndex + 24, dailyImages.length);
            const currentImages = dailyImages.slice(startIndex, endIndex);
            
            const imageHTML = currentImages.map((img, index) => {
                const globalIndex = startIndex + index;
                const isPremium = !isVIP;
                const blurClass = isPremium ? 'premium-content' : '';
                
                return `
                    <div class="gallery-item ${blurClass}" data-index="${globalIndex}">
                        <img src="uncensored/${img}" alt="Premium Photo ${globalIndex + 1}" loading="lazy" 
                             onerror="this.src='full/bikini.webp'; this.onerror=null;"
                             onclick="${isPremium ? `showPremiumModal('uncensored/${img}', 'image')` : `openLightbox('uncensored/${img}', ${globalIndex})`}">
                        <div class="gallery-overlay">
                            <div class="gallery-info">
                                <h4>Photo ${globalIndex + 1}</h4>
                                <p>${isPremium ? 'Premium €0.10' : 'VIP Access'}</p>
                            </div>
                        </div>
                        ${isPremium ? `
                            <div class="premium-overlay">
                                <div class="premium-badge" onclick="showPremiumModal('uncensored/${img}', 'image')">
                                    <span class="price">€0.10</span>
                                    <span class="unlock-text">Unlock</span>
                                </div>
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
            
            if (currentPage === 1) {
                galleryContainer.innerHTML = imageHTML;
            } else {
                galleryContainer.innerHTML += imageHTML;
            }
            
            // Actualizar botón de carga
            const loadMoreBtn = document.getElementById('loadMoreBtn');
            if (loadMoreBtn) {
                loadMoreBtn.style.display = endIndex < dailyImages.length ? 'block' : 'none';
            }
            
            console.log(`🖼️ Galería cargada: ${endIndex}/${dailyImages.length} imágenes`);
        }

        // ============================
        // VIDEOS
        // ============================
        function loadVideoContent() {
            const videoContainer = document.getElementById('video-gallery');
            if (!videoContainer) return;
            
            const videosToShow = dailyVideos.slice(0, 24);
            
            const videoHTML = videosToShow.map((video, index) => {
                const isPremium = !isVIP;
                const duration = `${Math.floor(Math.random() * 10) + 2}:${String(Math.floor(Math.random() * 60)).padStart(2, '0')}`;
                const blurClass = isPremium ? 'premium-content' : '';
                
                return `
                    <div class="video-item ${blurClass}" data-video="${video}">
                        <img src="full/bikini.webp" alt="Video ${index + 1}" class="video-thumbnail" loading="lazy"
                             onclick="${isPremium ? `showPremiumModal('uncensored-videos/${video}', 'video')` : `playVideo('uncensored-videos/${video}')`}">
                        <div class="video-duration">${duration}</div>
                        <div class="video-play-btn">▶</div>
                        ${isPremium ? `
                            <div class="premium-overlay">
                                <div class="premium-badge" onclick="showPremiumModal('uncensored-videos/${video}', 'video')">
                                    <span class="price">€0.30</span>
                                    <span class="unlock-text">Unlock Video</span>
                                </div>
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
            
            videoContainer.innerHTML = videoHTML;
            console.log(`🎬 Videos cargados: ${videosToShow.length}`);
        }

        function playVideo(videoPath) {
            console.log('Playing video:', videoPath);
            alert(`Playing video: ${videoPath.split('/').pop()}`);
        }

        // ============================
        // MODAL PREMIUM
        // ============================
        function showPremiumModal(contentPath, type) {
            const price = type === 'video' ? '€0.30' : '€0.10';
            
            const modal = document.createElement('div');
            modal.className = 'modal show';
            modal.style.cssText = `
                position: fixed; top: 0; left: 0; width: 100%; height: 100%;
                background: rgba(0, 0, 0, 0.9); z-index: 10000;
                display: flex; align-items: center; justify-content: center;
            `;
            
            modal.innerHTML = `
                <div class="modal-content" style="
                    background: rgba(26, 26, 46, 0.95); border-radius: 12px; padding: 30px;
                    max-width: 90%; max-height: 90%; position: relative; text-align: center;
                    backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.2);
                    color: white;
                ">
                    <span class="close-modal" onclick="this.closest('.modal').remove()" style="
                        position: absolute; top: 15px; right: 20px; font-size: 2rem;
                        color: #cccccc; cursor: pointer; transition: all 0.3s ease;
                    ">&times;</span>
                    <h2 style="color: #ff1493; margin-bottom: 20px;">💎 Premium Content</h2>
                    <p style="margin-bottom: 30px;">This ${type} requires a premium purchase.</p>
                    <div style="display: flex; gap: 20px; margin-top: 20px;">
                        <div style="text-align: center; padding: 20px; background: rgba(255, 255, 255, 0.1); border-radius: 12px; flex: 1;">
                            <h3>Single Purchase</h3>
                            <div style="font-size: 2rem; color: #ff1493; margin: 10px 0;">${price}</div>
                            <button onclick="simulatePayment('single'); this.closest('.modal').remove();" style="
                                background: linear-gradient(45deg, #ff1493, #ff69b4); color: white; border: none;
                                padding: 12px 25px; border-radius: 8px; cursor: pointer; font-weight: bold;
                            ">Buy Now</button>
                        </div>
                        <div style="text-align: center; padding: 20px; background: rgba(255, 215, 0, 0.1); border-radius: 12px; flex: 1;">
                            <h3>Full Access</h3>
                            <div style="font-size: 2rem; color: #ffd700; margin: 10px 0;">€9.99/month</div>
                            <button onclick="switchView('pricing'); this.closest('.modal').remove();" style="
                                background: linear-gradient(45deg, #ff1493, #ff69b4); color: white; border: none;
                                padding: 12px 25px; border-radius: 8px; cursor: pointer; font-weight: bold;
                            ">Get Full Access</button>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // ============================
        // PAYPAL
        // ============================
        function setupPayPal() {
            console.log('💳 Intentando configurar PayPal...');
            
            if (typeof paypal === 'undefined') {
                console.log('PayPal SDK no disponible, usando fallbacks');
                return;
            }
            
            try {
                // Pay Per View
                paypal.Buttons({
                    createOrder: function(data, actions) {
                        return actions.order.create({
                            purchase_units: [{
                                amount: { value: '0.99', currency_code: 'EUR' },
                                description: 'IbizaGirl.pics - Single Purchase'
                            }]
                        });
                    },
                    onApprove: function(data, actions) {
                        return actions.order.capture().then(function(details) {
                            handlePaymentSuccess('ppv', details);
                        });
                    },
                    style: { layout: 'vertical', color: 'blue', shape: 'rect' }
                }).render('#paypal-ppv').catch(() => {
                    console.log('PayPal PPV fallback');
                });

                // Monthly
                paypal.Buttons({
                    createOrder: function(data, actions) {
                        return actions.order.create({
                            purchase_units: [{
                                amount: { value: '9.99', currency_code: 'EUR' },
                                description: 'IbizaGirl.pics - Monthly Access'
                            }]
                        });
                    },
                    onApprove: function(data, actions) {
                        return actions.order.capture().then(function(details) {
                            handlePaymentSuccess('monthly', details);
                        });
                    },
                    style: { layout: 'vertical', color: 'gold', shape: 'rect' }
                }).render('#paypal-monthly').catch(() => {
                    console.log('PayPal Monthly fallback');
                });

                // Lifetime
                paypal.Buttons({
                    createOrder: function(data, actions) {
                        return actions.order.create({
                            purchase_units: [{
                                amount: { value: '49.99', currency_code: 'EUR' },
                                description: 'IbizaGirl.pics - Lifetime Access'
                            }]
                        });
                    },
                    onApprove: function(data, actions) {
                        return actions.order.capture().then(function(details) {
                            handlePaymentSuccess('lifetime', details);
                        });
                    },
                    style: { layout: 'vertical', color: 'gold', shape: 'rect' }
                }).render('#paypal-lifetime').catch(() => {
                    console.log('PayPal Lifetime fallback');
                });
                
                console.log('✅ PayPal configurado exitosamente');
            } catch (error) {
                console.log('PayPal error, fallbacks activos:', error);
            }
        }

        function simulatePayment(type) {
            const prices = { ppv: '€0.99', monthly: '€9.99', lifetime: '€49.99', single: '€0.10' };
            const price = prices[type] || '€0.99';
            
            if (confirm(`Procesar pago de ${price} para acceso ${type}?\n\n(Simulación para demo)`)) {
                // Simular éxito de pago
                const mockDetails = {
                    id: 'DEMO_' + Date.now(),
                    payer: { email_address: 'demo@example.com' }
                };
                
                handlePaymentSuccess(type, mockDetails);
            }
        }

        function handlePaymentSuccess(type, details) {
            console.log('Payment successful:', type, details);
            
            // Guardar acceso VIP
            const vipData = {
                type: type,
                purchaseDate: new Date().toISOString(),
                transactionId: details.id,
                payerEmail: details.payer.email_address
            };
            
            localStorage.setItem('vipAccess', JSON.stringify(vipData));
            isVIP = true;
            
            alert(`¡Pago exitoso! Ya tienes acceso ${type}.\nLa página se recargará para mostrar el contenido premium.`);
            window.location.reload();
        }

        // ============================
        // ANUNCIOS
        // ============================
        function setupAds() {
            console.log('📺 Configurando anuncios...');
            
            // JUICYADS
            setTimeout(() => {
                try {
                    if (typeof jads !== 'undefined') {
                        // Crear contenedores específicos para JuicyAds
                        const adTop = document.getElementById('ad-mobile-top');
                        const adSquare1 = document.getElementById('ad-square-1');
                        const adBottom = document.getElementById('ad-mobile-bottom');
                        const adSquareFooter = document.getElementById('ad-square-footer');
                        
                        if (adTop) {
                            adTop.innerHTML = '<div id="jads-2092250"></div>';
                            window.adsbyjuicy = window.adsbyjuicy || [];
                            window.adsbyjuicy.push({'adzone': '2092250'});
                        }
                        
                        if (adSquare1) {
                            adSquare1.innerHTML = '<div id="jads-2092251"></div>';
                            window.adsbyjuicy = window.adsbyjuicy || [];
                            window.adsbyjuicy.push({'adzone': '2092251'});
                        }
                        
                        if (adBottom) {
                            adBottom.innerHTML = '<div id="jads-2092471"></div>';
                            window.adsbyjuicy = window.adsbyjuicy || [];
                            window.adsbyjuicy.push({'adzone': '2092471'});
                        }
                        
                        if (adSquareFooter) {
                            adSquareFooter.innerHTML = '<div id="jads-2092470"></div>';
                            window.adsbyjuicy = window.adsbyjuicy || [];
                            window.adsbyjuicy.push({'adzone': '2092470'});
                        }
                        
                        console.log('✅ JuicyAds contenedores configurados');
                    }
                } catch (error) {
                    console.log('⚠️ JuicyAds fallback activo:', error);
                }
            }, 2000);
            
            // EXOCLICK
            setTimeout(() => {
                try {
                    // Banner 300x250
                    const script1 = document.createElement('script');
                    script1.type = 'text/javascript';
                    script1.innerHTML = `
                        var _pop = _pop || [];
                        _pop.push(['siteId', 6006884]);
                        _pop.push(['minBid', 0]);
                        _pop.push(['popundersPerIP', 1]);
                        _pop.push(['delayBetween', 0]);
                        _pop.push(['default', false]);
                        _pop.push(['defaultPerDay', 1]);
                        _pop.push(['topmostLayer', false]);
                        (function() {
                            var pa = document.createElement('script'); pa.type = 'text/javascript'; pa.async = true;
                            var s = document.getElementsByTagName('script')[0]; 
                            pa.src = '//c1.popads.net/pop.js';
                            pa.onerror = function() { console.log('ExoClick fallback activo'); };
                            s.parentNode.insertBefore(pa, s);
                        })();
                    `;
                    document.head.appendChild(script1);
                    console.log('✅ ExoClick/PopAds configurado');
                } catch (error) {
                    console.log('⚠️ ExoClick fallback activo:', error);
                }
            }, 3000);
            
            // ERO-ADVERTISING
            setTimeout(() => {
                try {
                    const script2 = document.createElement('script');
                    script2.type = 'text/javascript';
                    script2.src = '//ero-advertising.com/ads.js';
                    script2.onerror = function() { console.log('Ero-Advertising fallback activo'); };
                    document.head.appendChild(script2);
                    console.log('✅ Ero-Advertising configurado');
                } catch (error) {
                    console.log('⚠️ Ero-Advertising fallback activo:', error);
                }
            }, 4000);
        }

        // ============================
        // EVENT LISTENERS
        // ============================
        function setupEventListeners() {
            // Load More Button
            const loadMoreBtn = document.getElementById('loadMoreBtn');
            if (loadMoreBtn) {
                loadMoreBtn.addEventListener('click', () => {
                    currentPage++;
                    loadGalleryContent();
                });
            }
            
            // Hash navigation
            window.addEventListener('hashchange', () => {
                const hash = window.location.hash.substring(1);
                if (['gallery', 'videos', 'pricing'].includes(hash)) {
                    switchView(hash);
                }
            });
        }

        // ============================
        // LIGHTBOX
        // ============================
        function openLightbox(imagePath, index) {
            const lightbox = document.getElementById('lightbox');
            const lightboxImg = document.getElementById('lightbox-img');
            
            if (!lightbox || !lightboxImg) return;
            
            lightboxImg.src = imagePath;
            lightboxIndex = index;
            lightbox.classList.add('show');
            document.body.style.overflow = 'hidden';
            
            lightboxImages = dailyImages.map(img => `uncensored/${img}`);
        }

        function closeLightbox() {
            const lightbox = document.getElementById('lightbox');
            if (lightbox) {
                lightbox.classList.remove('show');
                document.body.style.overflow = '';
            }
        }

        function navigateLightbox(direction) {
            if (lightboxImages.length === 0) return;
            
            if (direction === 'prev') {
                lightboxIndex = lightboxIndex > 0 ? lightboxIndex - 1 : lightboxImages.length - 1;
            } else {
                lightboxIndex = (lightboxIndex + 1) % lightboxImages.length;
            }
            
            const lightboxImg = document.getElementById('lightbox-img');
            if (lightboxImg) {
                lightboxImg.src = lightboxImages[lightboxIndex];
            }
        }

        // ============================
        // ISABELLA AI
        // ============================
        let isabellaOpen = false;
        
        function toggleIsabella() {
            const window = document.getElementById('isabella-window');
            const button = document.getElementById('isabella-button');
            
            if (!window || !button) return;
            
            isabellaOpen = !isabellaOpen;
            
            if (isabellaOpen) {
                window.style.display = 'flex';
                button.style.transform = 'scale(0.8)';
            } else {
                window.style.display = 'none';
                button.style.transform = 'scale(1)';
            }
        }
        
        function sendQuickMessage(message) {
            const input = document.getElementById('isabella-input');
            if (input) {
                input.value = message;
                sendIsabellaMessage();
            }
        }
        
        function handleIsabellaEnter(event) {
            if (event.key === 'Enter') {
                sendIsabellaMessage();
            }
        }
        
        function sendIsabellaMessage() {
            const input = document.getElementById('isabella-input');
            if (!input) return;
            
            const message = input.value.trim();
            if (!message) return;
            
            addIsabellaMessage(message, 'user');
            input.value = '';
            
            showIsabellaTyping();
            
            setTimeout(() => {
                const response = getIsabellaResponse(message);
                hideIsabellaTyping();
                addIsabellaMessage(response, 'ai');
            }, 1500);
        }
        
        function addIsabellaMessage(message, type) {
            const messagesContainer = document.getElementById('isabella-messages');
            if (!messagesContainer) return;
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `isabella-message ${type}-message`;
            
            const time = new Date().toLocaleTimeString('es-ES', { hour: '2-digit', minute: '2-digit' });
            
            messageDiv.innerHTML = `
                <div class="message-content">
                    <p>${message}</p>
                </div>
                <div class="message-time">${time}</div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        function showIsabellaTyping() {
            const messagesContainer = document.getElementById('isabella-messages');
            if (!messagesContainer) return;
            
            const typingDiv = document.createElement('div');
            typingDiv.className = 'isabella-message ai-message typing-message';
            typingDiv.id = 'typing-indicator';
            
            typingDiv.innerHTML = `
                <div class="message-content">
                    <div class="typing-dots">
                        <span></span><span></span><span></span>
                    </div>
                </div>
            `;
            
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }
        
        function hideIsabellaTyping() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }
        
        function getIsabellaResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            if (lowerMessage.includes('precio') || lowerMessage.includes('cuesta')) {
                return `💰 ¡Te explico los precios!<br><br>
                        📸 <strong>Fotos individuales:</strong> €0.10 cada una<br>
                        🎬 <strong>Videos individuales:</strong> €0.30 cada uno<br>
                        📅 <strong>Acceso mensual:</strong> €9.99 (todo ilimitado)<br>
                        ♾️ <strong>Acceso de por vida:</strong> €49.99 (mejor valor)`;
            }
            
            if (lowerMessage.includes('premium') || lowerMessage.includes('acceso')) {
                return `🌟 <strong>Acceso Premium</strong><br><br>
                        Con el acceso premium obtienes:<br>
                        • 200+ fotos diarias de 572+ colección<br>
                        • 40+ videos diarios de 93+ HD collection<br>
                        • Contenido rotativo cada día<br>
                        • Sin restricciones ni blur<br>
                        • Acceso desde cualquier dispositivo`;
            }
            
            if (lowerMessage.includes('contenido') || lowerMessage.includes('fotos') || lowerMessage.includes('videos')) {
                return `📊 <strong>Nuestro Contenido</strong><br><br>
                        🖼️ <strong>572+ Fotos Premium:</strong> 200 diferentes cada día<br>
                        🎥 <strong>93+ Videos HD:</strong> 40 diferentes cada día<br>
                        🆕 <strong>Rotación diaria:</strong> Contenido siempre fresco<br>
                        📱 <strong>Compatible:</strong> Optimizado para móvil y desktop`;
            }
            
            return `¡Hola! 👋 Estoy aquí para ayudarte con cualquier duda sobre:<br>
                    💎 Precios y acceso premium<br>
                    💳 Métodos de pago seguro<br>
                    📊 Nuestro contenido (572+ fotos, 93+ videos)<br>
                    🆘 Soporte técnico<br><br>
                    ¿En qué puedo ayudarte específicamente? 😊`;
        }

        // ============================
        // FUNCIONES GLOBALES
        // ============================
        window.switchView = switchView;
        window.openLightbox = openLightbox;
        window.closeLightbox = closeLightbox;
        window.navigateLightbox = navigateLightbox;
        window.toggleIsabella = toggleIsabella;
        window.sendQuickMessage = sendQuickMessage;
        window.handleIsabellaEnter = handleIsabellaEnter;
        window.sendIsabellaMessage = sendIsabellaMessage;
        window.showPremiumModal = showPremiumModal;
        window.simulatePayment = simulatePayment;
        window.playVideo = playVideo;
        
        console.log('🎉 IbizaGirl.pics v4.0 FINAL completamente cargado y funcional');
    </script>
</body>
</html>