#!/usr/bin/env bash
set -euo pipefail
ROOT="$(cd "$(dirname "$0")/.." && pwd)"
mkdir -p "$ROOT/js"

PAYPAL_CLIENT_ID="${PAYPAL_CLIENT_ID:-${PUBLIC_PAYPAL_CLIENT_ID:-}}"
PAYPAL_PLAN_MONTHLY="${PAYPAL_PLAN_MONTHLY_1499:-${PUBLIC_PAYPAL_PLAN_MONTHLY_ID:-}}"
PAYPAL_PLAN_YEARLY="${PAYPAL_PLAN_ANNUAL_4999:-${PUBLIC_PAYPAL_PLAN_YEARLY_ID:-}}"
PAYPAL_LIFETIME_PRODUCT="${PAYPAL_LIFETIME_PRODUCT_ID:-${PUBLIC_PAYPAL_LIFETIME_PRODUCT_ID:-}}"

EXOCLICK_ZONE="${EXOCLICK_ZONE:-${PUBLIC_EXOCLICK_ZONE_ID:-}}"
JUICYADS_ZONE="${JUICYADS_ZONE:-${PUBLIC_JUICYADS_ZONE_ID:-${JUICYADS_PUB_ID:-}}}"
EROADS_ZONE="${EROADVERTISING_ZONE:-${PUBLIC_EROADS_WIDGET_ID:-}}"
POPADS_SITE_ID="${POPADS_SITE_ID:-${PUBLIC_POPADS_SITE_ID:-}}"
CRISP_WEBSITE_ID="${CRISP_WEBSITE_ID:-${PUBLIC_CRISP_WEBSITE_ID:-}}"

ENVIRONMENT="${PUBLIC_ENVIRONMENT:-production}"
CURRENCY="${PUBLIC_CURRENCY:-EUR}"

gen() {
cat > "$1" <<EOT
export const ENV = {
  PAYPAL_CLIENT_ID: "${PAYPAL_CLIENT_ID}",
  PAYPAL_PLAN_MONTHLY: "${PAYPAL_PLAN_MONTHLY}",
  PAYPAL_PLAN_YEARLY: "${PAYPAL_PLAN_YEARLY}",
  PAYPAL_LIFETIME_PRODUCT: "${PAYPAL_LIFETIME_PRODUCT}",
  EXOCLICK_ZONE_ID: "${EXOCLICK_ZONE}",
  JUICYADS_ZONE_ID: "${JUICYADS_ZONE}",
  EROADS_ZONE_ID: "${EROADS_ZONE}",
  POPADS_SITE_ID: "${POPADS_SITE_ID}",
  CRISP_WEBSITE_ID: "${CRISP_WEBSITE_ID}",
  ENVIRONMENT: "${ENVIRONMENT}",
  CURRENCY: "${CURRENCY}"
};
EOT
}

gen "$ROOT/js/env.js"
gen "$ROOT/env.js"
echo "env.js listo"
